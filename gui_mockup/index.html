<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Turing Wars GUI Mock</title>

    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
  <link rel="stylesheet" href="style.css">


  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>

<body>
    <div id="innerBody">
    <h1 id="title1">Turing &nbsp; wars</h1>


    <div id="player1progressbar" class="playerBoard">
        <div id="player1score" class="playerscore">0</div>
        <div class="bubbles"></div>
    </div>
    <canvas id="memoryMap" width="600" height="600"></canvas>
    <div id="player2progressbar" class="playerBoard">
        <div id="player2score" class="playerscore">0</div>
    </div>

    <div id="versus">
        <div id="player2name" class="playerName">Goliath</div>
        <div id="player1name" class="playerName">David</div>
        <div class="bubbles"></div>
    </div>
</div>

<script>
var c = document.getElementById("memoryMap");
var ctx = c.getContext("2d");

var boxSize=10;
var outerBoxSize=boxSize+3;
var canvasSize=600;

ctx.lineWidth=1;

var data = [];

for(var i=0; i<Math.floor((canvasSize-2)/outerBoxSize); i++) {
    data[i] = []
    for(var j=0; j<Math.floor((canvasSize-2)/outerBoxSize); j++) {
        
        
        var r = Math.random();

        if (r<0.01) {
            data[i][j] = "Y"
        } else if (r<0.3) {
            data[i][j] = "P"
        } else if (r<0.5) {
            data[i][j] = "B"
        } else {
            data[i][j] = "-"
        }
    }
}

function getColor(instruction){
    if (instruction=="Y") {
        return "#f09609";
    } else if (instruction=="P") {
        return "#ff0097";
    } else if (instruction=="B") {
        return "#1ba1e2";
    }
    return "#333";
}

function drawAt(x, y, color, full){
    ctx.beginPath();
    ctx.strokeStyle=color
    ctx.rect(2+x*outerBoxSize,2+y*outerBoxSize,boxSize,boxSize);
    ctx.stroke();

    if(full){
        ctx.fillStyle=color;
        ctx.fill();
    }
}

function eraseAtPos(x, y){
    ctx.beginPath();
    ctx.strokeStyle='rgba(0,0,0,1)'
    ctx.fillStyle='rgba(0,0,0,1)'
    ctx.rect(1+x*outerBoxSize,1+y*outerBoxSize,boxSize+2,boxSize+2);
    ctx.stroke();
    ctx.fill();
}

function drawAll() {
    for(var i=0; i<data.length; i++) {
        for(var j=0; j<data[0].length; j++) {
            var x = data[i][j]
            drawAt(i, j, getColor(x), false)
        }
    }
}

var lastDiffs = []

function drawDiff(newDiffs) {
    // rewrite old
    for(var i=0; i<lastDiffs.length; i++) {
        var diff = lastDiffs[i]

        eraseAtPos(diff.x, diff.y) // erase previous full square
        drawAt(diff.x, diff.y, getColor(diff.value), false) // draw empty square
    }

    //write new diff with fill style
    for(var i=0; i<newDiffs.length; i++) {
        var diff = newDiffs[i]

        eraseAtPos(diff.x, diff.y) // erase square
        drawAt(diff.x, diff.y, getColor(diff.value), true) // draw full square
    }

    lastDiffs = newDiffs;
}

function genDiff(x1,y1,x2,y2){
    var diff = [];

    //blue
    var nDiffsBlue = Math.ceil(5*Math.random())
    for(var i=0; i<nDiffsBlue; i++) {

        if (x1 >= data[0].length) {
            x1=0;
            y1++;
        }

        diff[i] = {'x':x1, 'y':y1, 'value':'B'}

        x1++
    }

    //pink
    var nDiffsPink = Math.ceil(5*Math.random())
    for(var i=0; i<nDiffsPink; i++) {

        if (x2 >= data[0].length) {
            x2=0;
            y2++;
        }

        diff[nDiffsBlue+i] = {'x':x2, 'y':y2, 'value':'P'}

        x2++
    }
    drawDiff(diff)

    setTimeout(() => genDiff(x1,y1, x2, y2), 100)
}

drawAll()
genDiff(0, 0, 0, 20)


</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-shape/1.2.0/d3-shape.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-color/2.1.2/jquery.color.min.js"></script>
<script src="water.js"></script>
</body>
</html>